import{a as T,b as f,c as L,d as U,e as w,f as O,g as V,l as D,m as G}from"./chunk-E7MIS4QH.js";import{a as M}from"./chunk-VHTBEU7Y.js";import{c as y,d as P,g as E,l as F}from"./chunk-EQG5L6AV.js";import{$a as l,Ca as h,Ha as s,Oa as a,Pa as d,R as v,Ra as r,Sa as o,Ta as u,Ua as N,X as _,Xa as C,Y as x,Ya as c,ab as b,bb as m,cb as S,fb as A,gb as I,ta as n,ya as g}from"./chunk-VEP5YUMW.js";function j(t,i){if(t&1&&(r(0,"div",11),l(1),o()),t&2){let e=c(2);n(),m(" ",e.successMessage," ")}}function q(t,i){if(t&1&&(r(0,"div",12),l(1),o()),t&2){let e=c(2);n(),m(" ",e.errorMessage," ")}}function k(t,i){t&1&&(r(0,"span"),l(1,"First name cannot exceed 50 characters"),o())}function $(t,i){if(t&1&&(r(0,"div",12),s(1,k,2,0,"span",1),o()),t&2){let e=c(2);n(),a("ngIf",e.firstName==null||e.firstName.errors==null?null:e.firstName.errors.maxlength)}}function z(t,i){t&1&&(r(0,"span"),l(1,"Last name cannot exceed 50 characters"),o())}function H(t,i){if(t&1&&(r(0,"div",12),s(1,z,2,0,"span",1),o()),t&2){let e=c(2);n(),a("ngIf",e.lastName==null||e.lastName.errors==null?null:e.lastName.errors.maxlength)}}function J(t,i){t&1&&(r(0,"span"),l(1,"Bio cannot exceed 500 characters"),o())}function K(t,i){if(t&1&&(r(0,"div",12),s(1,J,2,0,"span",1),o()),t&2){let e=c(2);n(),a("ngIf",e.bio==null||e.bio.errors==null?null:e.bio.errors.maxlength)}}function Q(t,i){t&1&&(r(0,"span"),l(1,"Updating..."),o())}function W(t,i){t&1&&(r(0,"span"),l(1,"Update Profile"),o())}function X(t,i){if(t&1){let e=N();r(0,"div")(1,"h2"),l(2,"My Account"),o(),u(3,"br"),s(4,j,2,1,"div",2)(5,q,2,1,"div",3),r(6,"form",4),C("ngSubmit",function(){_(e);let B=c();return x(B.updateAccount())}),r(7,"div",5),u(8,"input",6),s(9,$,2,1,"div",3),o(),r(10,"div",5),u(11,"input",7),s(12,H,2,1,"div",3),o(),r(13,"div",5),u(14,"textarea",8),s(15,K,2,1,"div",3),r(16,"small",9),l(17),o()(),r(18,"button",10),s(19,Q,2,0,"span",1)(20,W,2,0,"span",1),o()()()}if(t&2){let e=c();n(4),a("ngIf",e.successMessage),n(),a("ngIf",e.errorMessage),n(),a("formGroup",e.profileForm),n(2),d("error",(e.firstName==null?null:e.firstName.invalid)&&(e.firstName==null?null:e.firstName.touched)),n(),a("ngIf",(e.firstName==null?null:e.firstName.invalid)&&(e.firstName==null?null:e.firstName.touched)),n(2),d("error",(e.lastName==null?null:e.lastName.invalid)&&(e.lastName==null?null:e.lastName.touched)),n(),a("ngIf",(e.lastName==null?null:e.lastName.invalid)&&(e.lastName==null?null:e.lastName.touched)),n(2),d("error",(e.bio==null?null:e.bio.invalid)&&(e.bio==null?null:e.bio.touched)),n(),a("ngIf",(e.bio==null?null:e.bio.invalid)&&(e.bio==null?null:e.bio.touched)),n(2),m("",(e.bio==null||e.bio.value==null?null:e.bio.value.length)||0,"/500 characters"),n(),a("disabled",e.profileForm.invalid||e.isLoading),n(),a("ngIf",e.isLoading),n(),a("ngIf",!e.isLoading)}}function Y(t,i){t&1&&(r(0,"div"),l(1,"Loading profile..."),o())}function Z(t,i){if(t&1&&(r(0,"p")(1,"strong"),l(2,"Name:"),o(),l(3),o()),t&2){let e=c(3);n(3),S(" ",e.userProfile.firstName," ",e.userProfile.lastName," ")}}function ee(t,i){if(t&1&&(r(0,"p")(1,"strong"),l(2,"Bio:"),o(),l(3),o()),t&2){let e=c(3);n(3),m(" ",e.userProfile.bio," ")}}function te(t,i){if(t&1&&(r(0,"div")(1,"h2"),l(2),o(),r(3,"div",13)(4,"p")(5,"strong"),l(6,"Username:"),o(),l(7),o(),s(8,Z,4,2,"p",1)(9,ee,4,1,"p",1),o()()),t&2){let e=c(2);n(2),m("",e.userProfile.username,"'s Profile"),n(5),m(" ",e.userProfile.username,""),n(),a("ngIf",e.userProfile.firstName||e.userProfile.lastName),n(),a("ngIf",e.userProfile.bio)}}function ie(t,i){if(t&1&&(r(0,"div")(1,"h2"),l(2,"Profile Not Found"),o(),r(3,"p"),l(4),o()()),t&2){let e=c(2);n(4),b(e.errorMessage)}}function ne(t,i){if(t&1&&(r(0,"div"),s(1,Y,2,0,"div",1)(2,te,10,4,"div",1)(3,ie,5,1,"div",1),o()),t&2){let e=c();n(),a("ngIf",e.isLoading),n(),a("ngIf",!e.isLoading&&e.userProfile),n(),a("ngIf",!e.isLoading&&!e.userProfile&&e.errorMessage)}}var R=class t{constructor(i){this.route=i;this.username=this.route.snapshot.paramMap.get("usernameSlug")||"",this.profileForm=this.fb.group({firstName:["",[f.maxLength(50)]],lastName:["",[f.maxLength(50)]],bio:["",[f.maxLength(500)]]})}fb=v(D);username="";authService=v(M);profileForm;userProfile=null;isLoading=!1;errorMessage="";successMessage="";ngOnInit(){this.loadUserProfile()}get isOwnAccount(){return this.authService.getCurrentUser()?.username===this.username}loadUserProfile(){if(this.isOwnAccount){let i=this.authService.getCurrentUser();i&&(this.userProfile=i,this.populateForm(i))}else this.isLoading=!0,this.authService.getUserProfile(this.username).subscribe({next:i=>{this.userProfile=i,this.isLoading=!1},error:i=>{this.errorMessage="Failed to load user profile",this.isLoading=!1}})}populateForm(i){this.profileForm.patchValue({firstName:i.firstName||"",lastName:i.lastName||"",bio:i.bio||""})}updateAccount(){if(!this.profileForm.valid||!this.isOwnAccount)return;this.isLoading=!0,this.errorMessage="",this.successMessage="";let i=this.profileForm.value;this.authService.updateProfile(i).subscribe({next:e=>{this.userProfile=e,this.successMessage="Profile updated successfully!",this.isLoading=!1,setTimeout(()=>{this.successMessage=""},3e3)},error:e=>{this.errorMessage=e.error?.message||"Failed to update profile",this.isLoading=!1}})}get firstName(){return this.profileForm.get("firstName")}get lastName(){return this.profileForm.get("lastName")}get bio(){return this.profileForm.get("bio")}static \u0275fac=function(e){return new(e||t)(g(F))};static \u0275cmp=h({type:t,selectors:[["app-account"]],decls:4,vars:4,consts:[[1,"container"],[4,"ngIf"],["class","success-message",4,"ngIf"],["class","error-message",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"form-group"],["id","firstName","formControlName","firstName","placeholder","First Name","autocomplete","given-name","type","text",1,"text-input"],["id","lastName","formControlName","lastName","placeholder","Last Name","autocomplete","family-name","type","text",1,"text-input"],["id","bio","formControlName","bio","placeholder","Tell us about yourself...","rows","4",1,"text-input"],[1,"char-count"],["type","submit",1,"btn",3,"disabled"],[1,"success-message"],[1,"error-message"],[1,"profile-info"]],template:function(e,p){e&1&&(r(0,"div",0),s(1,X,21,16,"div",1),A(2,"async"),s(3,ne,4,3,"div",1),o()),e&2&&(n(),a("ngIf",I(2,2,p.authService.isAuthenticated$)&&p.isOwnAccount),n(2),a("ngIf",!p.isOwnAccount))},dependencies:[E,y,P,G,w,T,L,U,O,V],styles:[".char-count[_ngcontent-%COMP%]{margin:1rem 0;display:block}"]})};export{R as AccountComponent};
